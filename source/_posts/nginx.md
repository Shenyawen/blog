---
title: nginx
date: 2018-09-23 00:28:31
tags: nginx
---

这几天一直在搞一个项目的后台管理系统，因为有几个后台管理页面跟https接口因为是用在ios项目里的。本身自己是前端，这块基本没弄过，咨询了下后端的同事，加上买的服务器性能不是太好，果断使用系统占用少能负载均衡的nginx作为项目的端口转发及反向代理工具。

## nginx介绍

nginx是一个高性能的http和反向代理服务器，相较于 *** Apache ***\lighttpd轻量，系统占用内存少，稳定性、并发高同时拥有丰富的模块库以及友好灵活的配置。哦对了，这是一个老毛子写的软件，之前还以为是美国人写的...

### 名词解释
首先解释下什么是代理服务器
一般是指局域网内部的机器通过代理服务器发送请求到互联网上的服务器，代理服务器一般作用在客户端。这里面一般有两种代理方式：反向代理/正向代理

*** 反向代理 ***
按照我自己的理解就是: 客户端(client)向代理服务器(反向代理服务器命名空间)))发送一个请求，接着代理服务器自己判断向何处转发请求，并将获取的reponse返回给客户端(client)。一般情况下服务器为保证安全都会设有防火墙，只会对外暴露几个端口(:80 :22之类)，而服务器程序比如我用的是nodeJS启的服务一般情况下没有权限去监听公网ip1000(具体多少不清楚)以下的端口，这样就需要一个代理服务器，如果是web静态资源的话就需要监听80端口，https接口的话需要监听443端口，为了同时监听这些端口而且我也不想直接把我的程序直接暴露出去，那我们就可以通过nginx来监听:80跟:443端口，并将请求转发给内网的:8090端口。这实际上就是一种反向代理的应用场景。

*** 用途 ***：将防火墙后面的服务器提供给Internet用户访问。反向代理还可以为后端的多台服务器提供负载平衡或为后端较慢的服务器提供缓冲服务。

*** 正向代理 ***
正向代理是一个位于客户端(client)跟原始服务器之间的的服务器(代理服务器)，实际上就是代理请求，中间有一个代理服务

*** 用途 ***：在防火墙内的局域网客户端提供访问Internet的途径。还可以使用缓冲特性减少网络使用率。

### 与Apache对比
*** 相同点 ***：

1、都是HTTP服务器软件
2、功能上都采用模块化结构设计
3、都支持通用的语言接口，如PHP、Perl、Python等
4、支持正向、反向代理、虚拟主机、URL重写、压缩传输、SSL加密传输
 
*** 不同点 ***：

1、Apache处理速度很慢，占用很多内存资源
2、功能上，Apache所有模块支持动静态编译，Nginx模块都是静态编译的
3、对Fcgi的支持：Apache支持的很不好，Nginx支持非常好
4、处理连接方式：Nginx支持epoll,Apache不支持
5、空间使用上：Nginx安装包仅几百K

### nginx的优势
1、作为Web服务器，Nginx处理静态文件、索引文件，自动索引的效率非常高
2、作为代理服务器，Nginx可以实现无缓存的反向代理加速，提高网站运行速度
3、作为负载均衡服务器，Nginx既可以在内部直接支持Rails和PHP，也可以支持HTTP代理服务器对外进行服务，同时还支持简单的容错和利用算法进行负载均衡
4、在性能方面，Nginx是专门为性能优化而开发的，实现上非常注重效率。它采用内核Poll模型，可以支持更多的并发连接，最大可以支持对5万个并发连接数的响应，而且只占用很低的内存资源
5、在稳定性方面，Nginx采取了分阶段资源分配技术，使得CPU与内存的占用率非常低。Nginx官方表示，Nginx保持1万个没有活动的连接，而这些连接只占用2.5MB内存，因此，类似DOS这样的攻击对Nginx来说基本上是没有任何作用的
6、在高可用性方面，Nginx支持热部署，启动速度特别迅速，因此可以在不间断服务的情况下，对软件版本或者配置进行升级，即使运行数月也无需重新启动，几乎可以做到7x24小时不间断地运行

这点深有体会，服务器配置不高，但是基本实现了页面秒开(香港的服务器)
